"0","channel_sql = paste0(""select * from dl.dl_channel_umid_openid where substr(umid_firstonlinetime,1,10) >= '"",as.character(datestart),""' and dt = "",dateend.str)"
"0","new_user_channel_unique = read_data_impala_general(channel_sql)"
"0","colnames(new_user_channel_unique) = str_replace(colnames(new_user_channel_unique),""dl_channel_umid_openid."","""")"
"0","new_user_channel_unique = data.table(new_user_channel_unique)"
"0","new_user_channel_unique$date = str_sub(new_user_channel_unique$umid_firstonlinetime,1,10)"
"0","new_user_by_channel_date = new_user_channel_unique[,.(numbers = .N),by = c(""channel"",""date"")]"
"0","new_user_by_channel = new_user_channel_unique[,.(numbers = .N),by = c(""channel"")][order(numbers,decreasing = T)]"
"0","channel_list = new_user_by_channel$channel"
"0","new_user_by_channel_date_top = new_user_by_channel_date"
"0","new_user_by_channel_date_top$channels = factor(new_user_by_channel_date_top$channel,levels = channel_list)"
"0","new_user_by_channel_date_top_ordered = new_user_by_channel_date_top[order(date,channels)]"
"0","new_user_by_channel_date_ordered_reshape = dcast(new_user_by_channel_date_top_ordered, channels ~ date, value.var = ""numbers"")"
"0","new_user_by_channel_date_ordered_reshape$sum = rowSums(new_user_by_channel_date_ordered_reshape[,c(-1)],na.rm = T)"
"0","DT::datatable(new_user_by_channel_date_ordered_reshape, options = list(pageLength = 20))"
