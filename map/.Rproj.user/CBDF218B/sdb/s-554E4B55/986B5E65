{
    "collab_server" : "",
    "contents" : "library(maps)\nlibrary(mapdata)\n\nlibrary(maptools)\nx=readShapePoly('~/data/map_data/bou2_4p/bou2_4p.shp')#下文中会继续用到x这个变量，\n#如果你用的是其它的名称，\n#请在下文的程序中也进行相应的改动。\npar(mar=rep(0,4))\nplot(x)\nplot(x,col=rainbow(924))\nx[[1]]\n\nxx =readShapeSpatial('~/data/map_data/roa_4m/roa_4m.shp')\nlines(xx,col = \"yellow\")\n\nxxx = readShapeSpatial('~/data/map_data/rai_4m/rai_4m.shp')\nlines(xxx,col = \"red\")\n\nlibrary(rgdal)\n#new data from all_china\nchina_general = readShapeSpatial('~/data/map_data/all_china/国界线.shp')\nplot(china_general)\nchina_road = readShapeSpatial('~/data/map_data/all_china/主要公路.shp')\nlines(china_road,col = \"blue\")\nchina_river = readShapeSpatial('~/data/map_data/all_china/主要河流.shp')\n# china_river = rgdal::readOGR(dsn = '~/data/map_data/all_china',layer = \"主要河流\")\nplot(china_river)\nchina_railway = readShapeSpatial('~/data/map_data/all_china/主要铁路.shp')\nlines(china_railway,col = \"red\")\n\n# 上面的情况直接拿经纬度画图,有一定问题\n# 首先，我们需要指定x本身的投影信息，下面一行代码指定x对应的投影为原始的地理坐标（经纬度）：  \nproj4string(x) <- CRS(\"+proj=longlat +ellps=WGS84\")  \n# 然后我们指定新的投影方式，并将x投影到其上：  \nprojNew <- CRS(\"+proj=merc +lat_0=45n +lon_0=100e\")  \nxProj <- spTransform(x, projNew)  \n# 现在我们可以画出它了：  \ndev.new()  \nplot(xProj)  \n\ngetColor = function(mapdata, provnames, provcol, othercol){\n  f = function(x, y) ifelse(x %in% y, which(y == x), 0);\n  colIndex = sapply(mapdata@data$NAME, f, provnames);\n  fg = c(othercol, provcol)[colIndex + 1];\n  return(fg);\n}\n\nprovname = c(\"北京市\", \"天津市\", \"上海市\", \"重庆市\",'江苏省');\nprovcol = c(\"red\", \"green\", \"blue\", \"purple\",'yellow');\nplot(x, col = getColor(x, provname, provcol, \"grey\"))\n\nprovname = c(\"北京市\", \"天津市\", \"河北省\", \"山西省\", \"内蒙古自治区\",\n             \"辽宁省\", \"吉林省\", \"黑龙江省\", \"上海市\", \"江苏省\",\n             \"浙江省\", \"安徽省\", \"福建省\", \"江西省\", \"山东省\",\n             \"河南省\", \"湖北省\", \"湖南省\", \"广东省\",\n             \"广西壮族自治区\", \"海南省\", \"重庆市\", \"四川省\", \"贵州省\",\n             \"云南省\", \"西藏自治区\", \"陕西省\", \"甘肃省\", \"青海省\",\n             \"宁夏回族自治区\", \"新疆维吾尔自治区\", \"台湾省\",\n             \"香港特别行政区\");\npop = c(1633, 1115, 6943, 3393, 2405, 4298, 2730, 3824, 1858, 7625,\n        5060, 6118, 3581, 4368, 9367, 9360, 5699, 6355, 9449,\n        4768, 845, 2816, 8127, 3762, 4514, 284, 3748, 2617,\n        552, 610, 2095, 2296, 693);\nprovcol = rgb(red = 1 - pop/max(pop)/2, green = 1-pop/max(pop)/2, blue = 0);\nplot(x, col = getColor(x, provname, provcol, \"white\"), xlab = \"\", ylab = \"\")\n\ngetID = function(mapdata, provnames){\n  index = mapdata@data$NAME %in% provnames;\n  ids = rownames(mapdata@data[index, ]);\n  return(as.numeric(ids));\n}\nmidchina = c(\"河南省\", \"山西省\", \"湖北省\", \"安徽省\", \"湖南省\", \"江西省\");\nplot(x, recs = getID(x, midchina), col = \"green\", ol = \"white\", xlab = \"\",\n     ylab = \"\")\n\nplot(x, col = getColor(x, midchina, rep(\"green\", 6),\n                       \"white\"), border = \"white\", xlab = \"\", ylab = \"\")\n\n\ndat = read.csv(text = \"城市,jd,wd\n               北 京,116.4666667,39.9\n               上 海,121.4833333,31.23333333\n               天 津,117.1833333,39.15\n               重 庆,106.5333333,29.53333333\n               哈尔滨,126.6833333,45.75\n               长 春,125.3166667,43.86666667\n               沈 阳,123.4,41.83333333\n               呼和浩特,111.8,40.81666667\n               石家庄,114.4666667,38.03333333\n               太 原,112.5666667,37.86666667\n               济 南,117,36.63333333\n               郑 州,113.7,34.8\n               西 安,108.9,34.26666667\n               兰 州,103.8166667,36.05\n               银 川,106.2666667,38.33333333\n               西 宁,101.75,36.63333333\n               乌鲁木齐,87.6,43.8\n               合 肥,117.3,31.85\n               南 京,118.8333333,32.03333333\n               杭 州,120.15,30.23333333\n               长 沙,113,28.18333333\n               南 昌,115.8666667,28.68333333\n               武 汉,114.35,30.61666667\n               成 都,104.0833333,30.65\n               贵 阳,106.7,26.58333333\n               福 州,119.3,26.08333333\n               台 北,121.5166667,25.05\n               广 州,113.25,23.13333333\n               海 口,110.3333333,20.03333333\n               南 宁,108.3333333,22.8\n               昆 明,102.6833333,25\n               拉 萨,91.16666667,29.66666667\n               香 港,114.1666667,22.3\n               澳门,113.5,22.2\")\npar(mar=rep(0,4))\n\n\nlibrary(maps)\nlibrary(mapdata)\nmap(\"china\", col = \"darkgray\", ylim = c(18, 54), panel.first = grid())\npoints(dat$jd, dat$wd, pch = 19, col = rgb(0, 0, 0, 0.5))\ntext(dat$jd, dat$wd, dat[, 1], cex = 0.9, col = rgb(0,\n                                                    0, 0, 0.7), pos = c(2, 4, 4, 4, 3, 4, 2, 3, 4, 2, 4, 2, 2,\n                                                                        4, 3, 2, 1, 3, 1, 1, 2, 3, 2, 2, 1, 2, 4, 3, 1, 2, 2, 4, 4, 2))\naxis(1, lwd = 0); axis(2, lwd = 0); axis(3, lwd = 0); axis(4, lwd = 0)\n\nlibrary(sp)\nlibrary(spdep)\nlibrary(rgeos)\n\n# this part may help in deciding distance\n# Create toy SPDF\nfn <- system.file(\"etc/shapes/eire.shp\", package = \"spdep\")[1]\nprj <- CRS(\"+proj=utm +zone=30 +units=km\")\neire <- readShapeSpatial(fn, ID = \"names\", proj4string = prj)\n\n# Create a point of interest\npt.coords <-readWKT(\"POINT(260 5900)\")\neire.proj<-CRS(proj4string(eire))\nproj4string(pt.coords) <- eire.proj\n\n# check point is on the map\nplot(eire)\nplot(pt.coords, col=\"Red\", add=TRUE)\n\ncentroid.ED <-SpatialPoints(coordinates(eire))\nproj4string(centroid.ED) <- eire.proj\neire$distance <- gDistance(pt.coords,centroid.ED,byid=TRUE)\n",
    "created" : 1499940004150.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2750035061",
    "id" : "986B5E65",
    "lastKnownWriteTime" : 1500362013,
    "last_content_update" : 0,
    "path" : "~/R_Projects/map/Rfile/map_sh.R",
    "project_path" : "Rfile/map_sh.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 8,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}