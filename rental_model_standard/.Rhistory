untrace(getClosestRoadPoint)
temp = getClosestRoadPointFromDF(redstar_location)
temp = getClosestRoadPointFromDF(redstar_location)
result
10
result
temp = getClosestRoadPointFromDF(redstar_location)
source('~/R_Projects/rental_model_standard/Rfile/functions.R', encoding = 'UTF-8')
temp = getClosestRoadPointFromDF(redstar_location)
closest_road_list = temp
closest_road_df = rbindlist(closest_road_list)
View(closest_road_df)
debugSource('~/R_Projects/rental_model_standard/Rfile/functions.R', encoding = 'UTF-8')
getGaoDeDistrictInfo(enc2utf8("北京"))
raw_data <- fromJSON(geo_data)
raw_data
list.tree(raw_data)
debugSource('~/R_Projects/rental_model_standard/Rfile/functions.R', encoding = 'UTF-8')
debugSource('~/R_Projects/rental_model_standard/Rfile/functions.R', encoding = 'UTF-8')
getGaoDeDistrictInfo(enc2utf8("北京"))
list.tree(raw_data)
View(raw_data$districts[[2]])
raw_data$districts[[2]]$districts
length(result)
length(raw_data$districts[[2]]$districts)
debugSource('~/R_Projects/rental_model_standard/Rfile/functions.R', encoding = 'UTF-8')
getGaoDeDistrictInfo("常州")
getGaoDeDistrictInfo("常州")
raw_data
length(raw_data$districts)
debugSource('~/R_Projects/rental_model_standard/Rfile/functions.R', encoding = 'UTF-8')
getGaoDeDistrictInfo("上海")
debugSource('~/R_Projects/rental_model_standard/Rfile/functions.R', encoding = 'UTF-8')
getGaoDeDistrictInfo("上海")
length(raw_data$districts)
raw_data$districts
result_df
result_df
debugSource('~/R_Projects/rental_model_standard/Rfile/functions.R', encoding = 'UTF-8')
debugSource('~/R_Projects/rental_model_standard/Rfile/functions.R', encoding = 'UTF-8')
getGaoDeDistrictInfo("上海")
View(result_df)
View(redstar_points)
cities = unique(redstar_points$city)
rm(cities)
Encoding(city_list)
district_location_list = lapply(city_list,getGaoDeDistrictInfo)
district_location_df = rbindlist(district_location_list)
View(district_location_df)
source('~/R_Projects/rental_model_standard/Rfile/functions.R', encoding = 'UTF-8')
test_start = "39.983171,116.308479"
test_end = "39.996060,116.353455;39.949227,116.394310"
temp = getTencentRouteInfo(test_start,test_end)
temp = getTencentRouteInfo(test_start,test_end)
geo_data
getURL(paste("http://apis.map.qq.com/ws/distance/v1/?mode=driving&from=",start_location,"&to=",end_location,"&key=",key))
paste("http://apis.map.qq.com/ws/distance/v1/?mode=driving&from=",start_location,"&to=",end_location,"&key=",key)
Q
debugSource('~/R_Projects/rental_model_standard/Rfile/functions.R', encoding = 'UTF-8')
temp = getTencentRouteInfo(test_start,test_end)
result
test_end = "39.9075017400,116.3912022800"
temp = getTencentRouteInfo(test_start,test_end)
result
load("~/R_projects/rental_model_standard/2018_03_22_direction.RData")
View(redstar_direction_final_df)
View(result)
View(redstar_direction_df)
View(commerce_cord_result)
source("~/Rfile/R_impala.R")
community_data_sql = "select id,city,province,area,name,address,plate,areamonut,roommount,buildingdate,longitude,latitude,buildingamount,pricesection,ownermallname from ods.ods_db_dragoneye_xiwa_redstar_community_dt"
community_data = read_data_impala_general(community_data_sql)
View(community_data)
View(community_data[roommount > 0,])
View(community_data[community_data$roommount > 0,])
nrow(community_data)
View(redstar_location)
?google_places
library(googleway)
?google_places
nrow(community_data[community_data$city %in% redstar_points$city,])
nrow(community_data[community_data$city %in% paste0(redstar_points$city,"市"),])
View(redstar_location)
View(community_data[!str_detect(community_data$city,"市"),])
View(community_data)
View(community_data[str_detect(community_data$city,"(w+)市$"),])
View(community_data[str_detect(community_data$city,"市$"),])
str_detect("aaxx","w+")
str_detect("aaxx","(\w+)")
str_detect("aaxx","(\\w+)")
str_detect("城市","(\\w+)")
str_detect("市","(\\w+)")
str_detect("市","市(\\w+)")
str_detect("市啊","市(\\w+)")
View(community_data[str_detect(community_data$city,"市(\\w+)"),])
View(redstar_points)
View(community_data[str_detect(community_data$city,"呼和浩特"),])
View(community_data[str_detect(community_data$city,"鄂尔多斯"),])
head(str_extract("community_data$city","?=市"))
head(str_extract("community_data$city","(?=市)"))
str_detect("北京市","(?=市)")
str_extract("北京市","(?=市)")
str_extract("北京市","(\\w)(?=市)")
str_extract("北京市","(\\w+)(?=市)")
str_extract("中国著名城市北京市","(\\w+)(?=市)")
community_data$join_city = str_extract(community_data$city,"(\\w+)(?=市)")
View(community_data)
redstar_community_mixed_df = merge(redstar_location,community_data,by.x = "city",by.y = "join_city",all.x = TRUE)
redstar_community_mixed_df = merge(y=redstar_location,x=community_data,by.y = "city",by.x = "join_city",all.y = TRUE)
View(redstar_community_mixed_df)
View(redstar_points)
View(redstar_location)
str_extract("中国著名城市北京","(\\w+)(?=市)")
str_extract("中国著名城","(\\w+)(?=市)")
length(str_extract(community_data$city,"(\\w+)(?=市)"))
str_extract("沙市市","(\\w+)(?=市)")
str_extract("沙市市沙市","(\\w+)(?=市)")
View(str_extract(community_data$city,"(\\w+)(?=市)"))
?data.frame
View(data.frame(str_extract(community_data$city,"(\\w+)(?=市)")))
View(data.frame(ifelse(str_detect(community_data$city,"(\\w+)市$"),community_data$city,str_extract(community_data$city,"(\\w+)(?=市)"))))
str_detect("沙市市","(\\w+)市$")
View(data.frame(ifelse(!str_detect(community_data$city,"(\\w+)市$"),community_data$city,str_extract(community_data$city,"(\\w+)(?=市)"))))
community_data$join_city = ifelse(!str_detect(community_data$city,"(\\w+)市$"),community_data$city,str_extract(community_data$city,"(\\w+)(?=市)"))
redstar_community_mixed_df = merge(y=redstar_location,x=community_data,by.y = "city",by.x = "join_city",all.y = TRUE)
View(redstar_community_mixed_df)
redstar_community_distance = distHaversine(redstar_community_mixed_df[,c('longitude.x','latitude.x')],redstar_community_mixed_df[,c('longitude.y','latitude.y')])
library(geosphere)
redstar_community_distance = distHaversine(redstar_community_mixed_df[,c('longitude.x','latitude.x')],redstar_community_mixed_df[,c('longitude.y','latitude.y')])
View(redstar_community_mixed_df)
redstar_community_distance = cbind(redstar_community_mixed_df[,c("city","province","mall_name","area","name","address","plate","roommount","pricesection")],distance = redstar_community_distance)
View(redstar_community_distance)
View(redstar_community_distance)
redstar_community_distance = data.table(redstar_community_distance)
redstar_community_5km_number = redstar_community_distance[,sum(distance<=5000),by = mall_name]
View(redstar_community_5km_number)
View(redstar_community_distance)
?sum
View(redstar_community_distance[is.na(redstar_community_distance$distance),])
View(redstar_location)
redstar_community_5km_number = redstar_community_distance[,sum(distance<=5000,na.rm = TRUE),by = mall_name]
View(redstar_community_5km_number)
redstar_community_50km_number = redstar_community_distance[,sum(distance<=50000,na.rm = TRUE),by = mall_name]
View(redstar_community_50km_number)
nrow(redstar_community_distance[is.na(redstar_community_distance$roommount),])
nrow(redstar_community_distance[redstar_community_distance$roommount == 0,])
View(redstar_community_distance)
redstar_community_5km_roomnum = redstar_community_distance[distance<5000,.(roomnum = sum(roommount,na.rm = TRUE),roomnumavailablerate = sum(roommount==0)/.N,pricemorethan50k = sum(pricesection>50000)/sum(pricesection!=0),pricemorethan10k = sum(pricesection>10000)/sum(pricesection!=0)),by = mall_name]
redstar_community_50km_roomnum = redstar_community_distance[distance<50000,.(roomnum = sum(roommount,na.rm = TRUE),roomnumavailablerate = sum(roommount==0)/.N,pricemorethan50k = sum(pricesection>50000)/sum(pricesection!=0),pricemorethan10k = sum(pricesection>10000)/sum(pricesection!=0)),by = mall_name]
View(redstar_community_50km_roomnum)
View(redstar_community_distance)
View(redstar_community_distance)
redstar_community_5km_roomnum = redstar_community_distance[distance<5000,.(roomnum = sum(roommount,na.rm = TRUE),roomnumavailablerate = sum(roommount!=0)/.N,pricemorethan50k = sum(pricesection>50000)/sum(pricesection!=0),pricemorethan10k = sum(pricesection>10000)/sum(pricesection!=0)),by = mall_name]
redstar_community_50km_roomnum = redstar_community_distance[distance<50000,.(roomnum = sum(roommount,na.rm = TRUE),roomnumavailablerate = sum(roommount!=0)/.N,pricemorethan50k = sum(pricesection>50000)/sum(pricesection!=0),pricemorethan10k = sum(pricesection>10000)/sum(pricesection!=0)),by = mall_name]
View(redstar_community_5km_roomnum)
View(redstar_community_distance)
View(redstar_community_mixed_df)
redstar_community_5km_roomavailable = redstar_community_distance[distance<=5000,.(totalprice = sum(roommount*pricesection.na.rm = TRUE),totalnum = sum(.SD[!is.na(roommount*pricesection),roommount])),by = mall_name]
redstar_community_5km_roomavailable = redstar_community_distance[distance<=5000,.(totalprice = sum(roommount*pricesection,na.rm = TRUE),totalnum = sum(.SD[!is.na(roommount*pricesection),roommount])),by = mall_name]
View(redstar_community_5km_roomavailable)
redstar_community_5km_roomavailable = redstar_community_distance[distance<=5000,.(totalprice = sum(roommount*pricesection,na.rm = TRUE),totalnum = sum(.SD[(roommount*pricesection!=0),roommount]),avg_price = totalprice/totalnum),by = mall_name]
redstar_community_5km_roomavailable[,avg_price:=totalprice/totalnum]
View(redstar_community_5km_roomavailable)
source('~/Rfile/R_hana.R', encoding = 'UTF-8')
mall_p_flow_sql = "select * from dm.dm_mall_pass_flow_day"
temp = read_data_from_hana(mall_p_flow_sql)
mall_p_flow_sql = "select * from dm_mall_pass_flow_day"
temp = read_data_from_hana(mall_p_flow_sql)
temp_contract_detail = read_data_from_hana("select * from BIGBI.DIM_CONTRACT_BOOTH_DETAIL")
mall_p_flow_sql = "select * from bigbi.dm_mall_pass_flow_day"
temp = read_data_from_hana(mall_p_flow_sql)
hana_data = read_data_from_hana("select * from REDSTAR_BI.BI_ORDER_BRAND_AVG")
options(java.parameters)
options("java.parameters")
options(java.parameters = "- Xmx1024m")
temp = read_data_from_hana(mall_p_flow_sql)
source('~/Rfile/R_hana.R', encoding = 'UTF-8')
mall_p_flow_sql = "select * from bigbi.dm_mall_pass_flow_day"
temp = read_data_from_hana(mall_p_flow_sql)
View(temp)
unique(temp$MALL_NAME)
View(redstar_points)
View(redstar_points)
1.045…^1
1.045^10
View(redstar_community_50km_number)
View(redstar_community_5km_number)
View(redstar_community_5km_roomnum)
View(business_region)
View(community_data)
View(community_data[,c("city","name","pricesection")])
View(community_data[community_data$pricesection>0,c("city","name","pricesection")])
View(community_data[community_data$pricesection>0 & community_data$city == "北京市",c("city","name","pricesection")])
View(community_data[community_data$pricesection>0 & community_data$city == "上海市",c("city","name","pricesection")])
View(redstar_location)
city
city = unique(redstar_location$city)
city = paste0(city,"市")
community_data_focus = community_data[community_data$city %in% city,]
class(community_data_focus)
community_data_focus = data.table(community_data_focus)
?sample
View(community_data_focus)
community_data_sample = community_data_focus[,.SD[1:10,],by = "city"]
View(community_data_sample)
sample(city,10)
community_data_sample = community_data_focus[,.SD[sample(nrow(.SD),10),],by = "city"]
View(community_data_sample)
community_data_sample = community_data_focus[pricesection > 0,.SD[sample(nrow(.SD),10),],by = "city"]
community_data_sample = community_data_sample[,c("city","name","pricesection")]
View(community_data_sample)
View(redstar_result)
View(commerce_cord_final_result)
View(commerce_cord_result)
View(commerce_cord_result[str_detect(commerce_cord_result$pv,"其他$"),c("lat","lon","lat2","lon2")])
View(commerce_cord_final_result)
head(business_region_final)
commerce_cord_final_result = commerce_cord_result[,c("pv","lon","lat")]
commerce_cord_final_result = cbind(city = business_region_final$city_name,commerce_cord_final_result)
commerce_cord_final_result$city = as.character(commerce_cord_final_result$city)
commerce_cord_final_result = merge(redstar_location,commerce_cord_final_result,by = "city",allow.cartesian=TRUE)
commerce_cord_final_result$commerce_distance = distHaversine(commerce_cord_final_result[,c('longitude','latitude')],commerce_cord_final_result[,c('lon','lat')])
library(geosphere)
library(readxl)
library(data.table)
library(pinyin)
library(geosphere)
commerce_cord_final_result$commerce_distance = distHaversine(commerce_cord_final_result[,c('longitude','latitude')],commerce_cord_final_result[,c('lon','lat')])
View(commerce_cord_final_result)
commerce_distance_df = commerce_cord_final_result[,.(commerce_distance = min(commerce_distance)),by = "mall_name"]
View(commerce_distance_df)
redstar_result = merge(redstar_result,commerce_distance_df,by = "mall_name")
head(redstar_location)
redstar_result = redstar_location #redstar_result don't have an order
View(result_subway)
head(subway_distance)
head(closest_subway)
View(closest_subway)
subway_distance = distHaversine(redstar_location[,c('longitude','latitude')],closest_subway[,c('X2','X1')])
result_subway = cbind(mall_name = redstar_location$mall_name,subway_distance)
redstar_result = merge(redstar_result,result_subway,by = "mall_name")
View(redstar_result)
View(result_subway)
redstar_result = merge(redstar_result,commerce_distance_df,by = "mall_name")
redstar_result$mall_name = factor(redstar_result$mall_name,levels = redstar_location$mall_name,ordered = TRUE)
redstar_result = redstar_result[order(redstar_result$mall_name),]
View(redstar_result)
head(shop_commerce_count)
shop_commerce_count = commerce_cord_final_result[,.(distance_commerce_in_2500 = sum(commerce_distance<2500)),by = mall_name]
redstar_result = merge(redstar_result,shop_commerce_count,by = "mall_name")
View(redstar_result)
head(closest_road_list)
head(closest_road_df)
head(closest_road_distance)
closest_road_distance = distHaversine(redstar_location[,c('longitude','latitude')],closest_road_df[,c('lng','lat')])
closest_road_distance_df = cbind(mall_name = redstar_location$mall_name,closest_road_distance)
redstar_result = merge(redstar_result,closest_road_distance_df,by = "mall_name")
head(district_location_df)
head(district_lat_lon_matrix)
class(district_lat_lon_matrix)
head(district_location_list)
View(redstar_four_direction_final_df)
head(redstar_four_direction_df)
View(redstar_direction_final_df)
nrow(redstar_direction_final_df)
View(redstar_four_direction_df)
redstar_four_direction_df = makeFourDirectionFromDF(redstar_location)
View(redstar_four_direction_df)
View(redstar_four_direction_mixed_df)
redstar_four_direction_mixed_df = merge(redstar_location,redstar_direction_df,by = "mall_name",allow.cartesian=TRUE)
redstar_four_direction_mixed_df = as.data.frame(redstar_four_direction_mixed_df)
redstar_four_direction_df = list()
View(redstar_four_direction_final_df)
proxy_url
Sys.getenv("http_proxy")
Sys.setenv(http_proxy = proxy_url, https_proxy = proxy_url, ftp_proxy = proxy_url)
for(i in 2:7){
redstar_four_direction_df[[i]] = getDirectionInfoFromDF(redstar_four_direction_mixed_df[(40*(i-1)+1):(40*i),])
}
source('~/R_Projects/rental_model_standard/Rfile/functions.R', encoding = 'UTF-8')
for(i in 2:7){
redstar_four_direction_df[[i]] = getDirectionInfoFromDF(redstar_four_direction_mixed_df[(40*(i-1)+1):(40*i),])
}
head(redstar_four_direction_df)
redstar_four_direction_final_df = rbindlist(redstar_four_direction_df)
nrow(redstar_four_direction_final_df)
View(redstar_four_direction_final_df)
View(redstar_four_direction_mixed_df)
redstar_four_direction_df[[1]] = getDirectionInfoFromDF(redstar_four_direction_mixed_df[1:40,])
redstar_four_direction_df[[1]] = getDirectionInfoFromDF(redstar_four_direction_mixed_df[1:40,])
redstar_four_direction_final_df = rbindlist(redstar_four_direction_df)
View(redstar_four_direction_final_df)
redstar_four_direction_final_df = redstar_four_direction_final_df[1:260,]
combined_highway_raw_df = rbind(redstar_direction_final_df,redstar_four_direction_final_df)
combined_highway_raw_dt = data.table(combined_highway_raw_df)
shortest_distance_result = combined_highway_raw_dt[,.(highway_distance = min(highway_distance),district_center_distance = min(distance,na.rm = TRUE)),by = "start_point"]
redstar_result = merge(redstar_result,shortest_distance_result,by.x = "mall_name",by.y = "start_point")
View(redstar_result)
source("~/Rfile/R_impala.R")
community_data_sql = "select id,city,province,area,name,address,plate,areamonut,roommount,buildingdate,longitude,latitude,buildingamount,pricesection,ownermallname from ods.ods_db_dragoneye_xiwa_redstar_community_dt"
community_data = read_data_impala_general(community_data_sql)
View(community_data)
View(redstar_community_mixed_df)
View(redstar_community_distance)
View(redstar_community_5km_roomavailable)
save.image("~/R_Projects/rental_model_standard/.RData")
View(redstar_result)
View(community_data_focus)
community_data_sample = community_data_focus[pricesection > 0,.SD[sample(nrow(.SD),10),],by = "city"]
community_data_sample = community_data_sample[,c("city","name","address","pricesection")]
2196814/56855
library(readxl)
rent_original = read_xlsx("C:\Users\qingye.yuan\Desktop\工作需要\租金定价\租金定价模型二期数据.xlsx")
rent_original = read_xlsx("C:/Users/qingye.yuan/Desktop/工作需要/租金定价/租金定价模型二期数据.xlsx")
View(rent_original)
str(rent_original)
rent_original = as.data.frame.numeric(rent_original)
View(rent_original)
rent_original = read_xlsx("C:/Users/qingye.yuan/Desktop/工作需要/租金定价/租金定价模型二期数据.xlsx")
?lapply
rent_original[] = lapply(rent_original,as.numeric)
View(rent_original)
rent_original = read_xlsx("C:/Users/qingye.yuan/Desktop/工作需要/租金定价/租金定价模型二期数据.xlsx")
mall_name = rent_original$MALL_NAME
rent_original[] = lapply(rent_original,as.numeric)
rent_original$MALL_NAME = mall_name
View(rent_original)
rent_original$avg_price = rent_original$ZX_PRICE/rent_original$RENT_AREA_WA
View(rent_original)
View(rent_original[,c("MALL_NAME","avg_price")])
1.05^10
library(rvest)
city_gdp_url = "https://wenku.baidu.com/view/b97475622f3f5727a5e9856a561252d380eb2021.html"
city_gdp_page = read_html(city_gdp_url)
city_gdp = city_gdp_page %>% html_nodes('div.bd>p.reader-word-layer') %>% html_text()
city_gdp = city_gdp_page %>% html_nodes('div.bd p.reader-word-layer') %>% html_text()
city_gdp = city_gdp_page %>% html_nodes('p.reader-word-layer') %>% html_text()
city_gdp
city_gdp = city_gdp_page %>% html_nodes('p') %>% html_text()
city_gdp
city_gdp = city_gdp_page %>% html_nodes('div') %>% html_text()
city_gdp
city_gdp = city_gdp_page %>% html_nodes('div')
city_gdp = city_gdp_page %>% html_nodes('div.bd')
city_gdp = city_gdp_page %>% html_nodes('div.bd>p')
city_gdp = city_gdp_page %>% html_nodes('.reader-pic-item')
city_gdp
city_gdp_url = "https://wenku.baidu.com/view/b97475622f3f5727a5e9856a561252d380eb2021.html"
city_gdp_page = read_html(city_gdp_url)
city_gdp = city_gdp_page %>% html_nodes('.reader-pic-item') %>% html_text()
city_gdp
city_gdp = city_gdp_page %>% html_nodes('div.reader-pic-item') %>% html_text()
city_gdp
city_gdp_url = "http://www.sohu.com/a/219596742_683734"
city_gdp_page = read_html(city_gdp_url)
city_gdp = city_gdp_page %>% html_nodes('article#mp-editor') %>% html_text()
city_gdp
str(city_gdp)
city_gdp_page = read_html(city_gdp_url)
city_gdp = city_gdp_page %>% html_nodes('article#mp-editor')
library(magrittr)
city_gdp %>% html_text()
city_gdp = city_gdp_page %>% html_nodes('article#mp-editor') %>% html_text()
head(city_gdp)
city_gdp = city_gdp_page %>% html_nodes('article#mp-editor p') %>% html_text()
city_gdp
a = 5
a
print(city_gdp)
a = 5
a
city_gdp_url = "http://www.sohu.com/a/219596742_683734"
city_gdp_page = read_html(city_gdp_url)
city_gdp = city_gdp_page %>% html_nodes('article#mp-editor') %>% html_text()
library(rvest)
library(magrittr)
city_gdp = city_gdp_page %>% html_nodes('article#mp-editor') %>% html_text()
city_gdp_page = read_html(city_gdp_url)
city_gdp = city_gdp_page %>% html_nodes('article#mp-editor') %>% html_text()
city_gdp
city_gdp = city_gdp_page %>% html_nodes('article#mp-editor p') %>% html_text()
city_gdp
str_detect(city_gdp,"^\d")
str_detect(city_gdp,"^\\d")
head(city_gdp)
str_detect(city_gdp,"^\\d\.")
str_detect(city_gdp,"^\\d\\.")
str_detect(city_gdp,"^[\\d]{1,2}\\.")
city_gdp = city_gdp[str_detect(city_gdp,"^[\\d]{1,2}\\.")]
city_gdp
str_extract(city_gdp,"\\d+(?=亿元)")
gdp = str_extract(city_gdp,"\\d+(?=亿元)")
str_extract(city_gdp,"\\d+(?=万)")
population = str_extract(city_gdp,"\\d+(?=万)")
str_extract(city_gdp,"(?<=同比增长)\\w+(?=%)")
str_extract(city_gdp,"(?<=同比增长)\\w+(?=\\%)")
str_extract(city_gdp,"(?<=同比增长)\\w+")
str_extract(city_gdp,"\\w+(?=\\%)")
str_extract(city_gdp,"(?<=同比增长)\\d+")
str_extract("同比增长123","(?<=同比增长)\\d+")
str_extract("aaa123","(?<=aaa)\\d+")
str_extract("abcd123","(?<=abcd)\\d+")
Encoding("同比增长")
guess_encoding("同比增长")
Sys.setlocale(category = "LC_ALL", locale = "English_United States.1252")
guess_encoding("同比增长")
str_extract("同比增长123","(?<=同比增长)\\d+")
str_extract("abcd123","(?<=abcd)\\d+")
str_extract("123同比增长","\\d+(?<=同比增长)")
str_extract("123同比增长","\\d+(?=同比增长)")
str_extract("123同比增长123","\\d+(?<=同比增长)")
increasing_rate = str_extract(city_gdp,"\\d+(?=%)")
str_extract(city_gdp,"\\d+(?=%)")
str_extract(city_gdp,"\\d+(\\.)?\\d+(?=%)")
str_extract(city_gdp,"\\d+(\\.)?\\d*(?=%)")
increasing_rate = str_extract(city_gdp,"\\d+(\\.)?\\d*(?=%)")
str_extract(city_gdp,"(?<=\d+)\w+(?=\d)")
str_extract(city_gdp,"(?<=\\d+)\\w+(?=\\d)")
str_extract(city_gdp,"(?<=\\d+)\\w+(?=\\d)")
str_extract(city_gdp,"(?<=\\d+)\\w+(?=(\\d){1}")
str_extract(city_gdp,"(?<=\\d+)(\\w){1,3}(?=\\d)")
str_extract(city_gdp,"(?<=\\d+\\.)\\w")
str_extract(city_gdp,"(?<=(\\d){1,2}\\.)\\w")
str_extract(city_gdp,"(?<=(\\d){1,2}\\.)\\w{2,4}")
str_extract(city_gdp,"(?<=(\\d){1,2}\\.)[^0-9]{2,4}")
str_extract(city_gdp,"(?<=(\\d){1,2}\\.)[^0-9\\(]{2,4}")
str_extract(city_gdp,"(?<=(\\d){1,2}\\.)[^0-9（]{2,4}")
str_extract(city_gdp,"(?<=(\\d){1,2}\\.)[^0-9a-z]{2,4}")
str_extract(city_gdp,"(?<=(\\d){1,2}\\.)[^（]{2,4}")
str_extract(city_gdp,"(?<=(\\d){1,2}\\.)[^3]{2,4}")
str_extract(city_gdp,"(?<=(\\d){1,2}\\.)[^0]{2,4}")
str_extract(city_gdp,"(?<=(\\d){1,2}\\.)[^长沙]{2,4}")
str_extract(city_gdp,"(?<=(\\d){1,2}\\.)[^（]{2,4}")
str_extract(city_gdp,"(?<=(\\d){1,2}\\.)[^\\（]{2,4}")
str_detect("(","(")
str_detect("(","\\(")
str_detect("（","（")
str_detect("（","\\（")
str_detect("（","[^\\（]")
str_detect("武汉（","[^\\（]")
str_extract("武汉（","[^\\（]")
str_extract("武汉（","[^\\（]+")
str_extract(city_gdp,"(?<=(\\d){1,2}\\.)[^\\（]+")
str_detect(city_gdp,"（")
str_detect(city_gdp,"\\（")
str_detect(city_gdp,"\\(")
str_detect(city_gdp,"\\(")
str_detect(city_gdp,"\\（")
str_detect(city_gdp,"\\(")
str_detect(city_gdp,"\\(")
str_detect(city_gdp,"\\（")
str_detect(city_gdp,"\\（")
str_detect(city_gdp,"\\（")
guess—guess_encoding(city_gdp)
guess_encoding(city_gdp)
str_extract(city_gdp,"(?<=\\d+\\.)\\w")
str_extract(city_gdp,"(?<=\\d\\.)\\w")
str_extract(city_gdp,"(?<=\\d\\.)\\w+(?=\\d)")
str_extract(city_gdp,"(?<=\\d\\.)\\w+(?=亿元)")
str_extract(city_gdp,"\\w+(?=亿元)")
str_extract(city_gdp,"(?<=\\d\\.)[^0-9]+(?=\\d)")
str_extract(city_gdp,"(?<=\\d\\.)[^0-9]+(?=\\d{2,})")
str_extract(city_gdp,"(?<=\\d\\.)[^0-9]+(?=(\\d){2,})")
str_extract(city_gdp,"(?<=\\d\\.)[^0-9]+(?=(\\d){2,100})")
str_extract(city_gdp,"(?<=\\d\\.)[^0-9]+(?=(\\d))")
str_extract(city_gdp,"(?<=\\d\\.)[\\D]+(?=(\\d))")
str_extract(city_gdp,"(?<=\\d\\.)[\\D]+(?=(\\d){2})")
str_extract(AA7500,"[\\D]+(?=(\\d){2})")
str_extract("AA7500","[\\D]+(?=(\\d){2})")
str_extract(city_gdp,"(?<=\\d\\.)[\\w]+(?=(\\d){2})")
str_extract(city_gdp,"(?<=\\d\\.)\\w+(?=(\\d){2})")
str_extract(city_gdp,"(?<=\\d\\.)[^a-z]+(?=(\\d){2})")
str_extract(city_gdp,"(?<=\\d\\.)[^a-z]+?(?=(\\d){2})")
str_detect("（","\\（")
str_detect("（","\\（")
str_detect(city_gdp,"\\（")
str_detect("（","\\（")
guess_encoding(city_gdp)
temp = iconv(city_gdp,'utf-8','gbk')
head(temp)
guess_encoding()
guess_encoding(temp)
str_extract(city_gdp,"(?<=\\d\\.)\\w(?=\\（")
str_extract(city_gdp,"(?<=\\d\\.)\\w(?=(\\（)")
str_extract(city_gdp,"(?<=\\d\\.)\\w(?=(\\（")))
str_extract(city_gdp,"(?<=\\d\\.)\\w(?=\\（))
)
)
)
str_extract(city_gdp,"(?<=\\d\\.)[^a-z]+?(?=(\\d){2})")
str_extract(temp,"(?<=\\d\\.)[^a-z]+?(?=(\\d){2})")
str_extract(temp,"(?<=\\d\\.)\\w(?=(\\d){2})")
str_extract(temp,"(?<=\\d\\.)(\\w)+(?=(\\d){2})")
str_extract(temp,"(?<=\\d\\.)[^a-z]+(?=(\\d){2})")
str_extract(temp,"(?<=\\d\\.)[^a-z]+(?=(\\（))")
head(name)
city_name = str_extract(city_gdp,"(?<=\\d\\.)[^a-z]+?(?=(\\d){2})")
city_name
library(tabulizer)
city_gdp1 = extract_tables("D://downloads//gdp_ranking1.jpg")
city_gdp_pdf = extract_tables("D://downloads//gdp_ranking.pdf")
city_gdp_pdf
city_gdp_pdf = extract_tables("D://downloads//gdp_ranking.pdf")
malls = extract_tables("C://Users/qingye.yuan/Downloads/mall.pdf",encoding = "UTF-8")
rm(malls)
city_gdp_pdf = extract_tables("D://downloads//gdp_ranking.pdf",encoding = "UTF-8",pages = 2)
city_gdp_pdf
?extract_tables
library(tesseract)
gdp_pic1  <- ocr("D://downloads//gdp_ranking1.jpg")
gdp_pic1
help(package = "tesseract")
